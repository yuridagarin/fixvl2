Include("\\script\\lib\\globalfunctions.lua")
Include("\\settings\\static_script\\missions\\base\\mission_award_base.lua")
Include("\\script\\misc\\observer\\observer_head.lua")

ITEM_G = 2
ITEM_D = 1
tYunLingLv4 = {
    {{"H-LiÖt Nham-Lv4"    ,{0,148,53,1}, {1, 100}},3000},
    {{"H-Ph¸ Kh«ng-Lv4"    ,{0,148,54,1}, {1, 100}},3000},
    {{"H-Tóy KiÕm-Lv4"    ,{0,148,55,1}, {1, 100}},2000},
    {{"H-TËt Phong-Lv4"    ,{0,148,56,1}, {1, 100}},2000},
    {{"H-TÊn Vò-Lv4"    ,{0,148,57,1}, {1, 100}},2000},
    {{"H-¦ng TËp-Lv4"    ,{0,148,58,1}, {1, 100}},2000},
    {{"H-Linh T©m-Lv4"    ,{0,148,59,1}, {1, 100}},2000},
    {{"H-ThÇn Lùc-Lv4"    ,{0,148,60,1}, {1, 100}},2000},
    {{"H-Ng­ng ThÇn-Lv4"    ,{0,148,61,1}, {1, 100}},2000},
    {{"H-V« Gian-Lv4"    ,{0,148,62,1}, {1, 100}},2000},
    {{"H-V« Cùc-Lv4"    ,{0,148,63,1}, {1, 100}},2000},
    {{"H-Cuång NhÉn-Lv4"    ,{0,148,64,1}, {1, 100}},2000},
    {{"H-L¨ng NhuÖ-Lv4"    ,{0,148,65,1}, {1, 100}},2000},
    {{"H-Linh Viªn-Lv4"    ,{0,148,66,1}, {1, 100}},2000},
    {{"H-H¶i VËn-Lv4"    ,{0,148,67,1}, {1, 100}},2000},
    {{"H-H¶i T©m-Lv4"    ,{0,148,68,1}, {1, 100}},2000},
    {{"T-LiÖt Nham-Lv4"    ,{0,150,53,1}, {1, 100}},2000},
    {{"T-Ph¸ Kh«ng-Lv4"    ,{0,150,54,1}, {1, 100}},2000},
    {{"T-Tóy KiÕm-Lv4"    ,{0,150,55,1}, {1, 100}},2000},
    {{"T-TËt Phong-Lv4"    ,{0,150,56,1}, {1, 100}},2000},
    {{"T-TÊn Vò-Lv4"    ,{0,150,57,1}, {1, 100}},2000},
    {{"T-V« L­îng-Lv4"    ,{0,150,58,1}, {1, 100}},2000},
    {{"T-Môc Minh-Lv4"    ,{0,150,59,1}, {1, 100}},2000},
    {{"T-ThÇn Lùc-Lv4"    ,{0,150,60,1}, {1, 100}},2000},
    {{"T-Ng­ng ThÇn-Lv4"    ,{0,150,61,1}, {1, 100}},2000},
    {{"T-V« Gian-Lv4"    ,{0,150,62,1}, {1, 100}},2000},
    {{"T-V« Cùc-Lv4"    ,{0,150,63,1}, {1, 100}},2000},
    {{"T-Cuång NhÉn-Lv4"    ,{0,150,64,1}, {1, 100}},2000},
    {{"T-L¨ng NhuÖ-Lv4"    ,{0,150,65,1}, {1, 100}},2000},
    {{"T-Linh Viªn-Lv4"    ,{0,150,66,1}, {1, 100}},2000},
    {{"T-H¶i VËn-Lv4"    ,{0,150,67,1}, {1, 100}},2000},
    {{"T-H¶i T©m-Lv4"    ,{0,150,68,1}, {1, 100}},2000},
    {{"C-LiÖt Nham-Lv4"    ,{0,149,53,1}, {1, 100}},2000},
    {{"C-Ph¸ Kh«ng-Lv4"    ,{0,149,54,1}, {1, 100}},2000},
    {{"C-Tóy KiÕm-Lv4"    ,{0,149,55,1}, {1, 100}},2000},
    {{"C-TËt Phong-Lv4"    ,{0,149,56,1}, {1, 100}},2000},
    {{"C-TÊn Vò-Lv4"    ,{0,149,57,1}, {1, 100}},2000},
    {{"C-Qu¸n Th¹ch-Lv4"    ,{0,149,58,1}, {1, 100}},2000},
    {{"C-Né Ng©m-Lv4"    ,{0,149,59,1}, {1, 100}},2000},
    {{"C-Xuyªn V©n-Lv4"    ,{0,149,60,1}, {1, 100}},2000},
    {{"C-ThÇn Lùc-Lv4"    ,{0,149,61,1}, {1, 100}},2000},
    {{"C-Ng­ng ThÇn-Lv4"    ,{0,149,62,1}, {1, 100}},2000},
    {{"C-V« Gian-Lv4"    ,{0,149,63,1}, {1, 100}},2000},
    {{"C-V« Cùc-Lv4"    ,{0,149,64,1}, {1, 100}},2000},
    {{"C-Cuång NhÉn-Lv4"    ,{0,149,65,1}, {1, 100}},2000},
    {{"C-L¨ng NhuÖ-Lv4"    ,{0,149,66,1}, {1, 100}},2000},
    {{"C-Linh Viªn-Lv4"    ,{0,149,67,1}, {1, 100}},2000},
    {{"C-H¶i VËn-Lv4"    ,{0,149,68,1}, {1, 100}},2000},
    {{"C-H¶i T©m-Lv4"    ,{0,149,69,1}, {1, 100}},2000},
}

tYunLingLv5 = {
    {{"C-LiÖt Nham-Lv5"    ,{0,149,70,1}, {1, 100}},3000},
    {{"C-Ph¸ Kh«ng-Lv5"    ,{0,149,71,1}, {1, 100}},3000},
    {{"C-Tóy KiÕm-Lv5"    ,{0,149,72,1}, {1, 100}},2000},
    {{"C-TËt Phong-Lv5"    ,{0,149,73,1}, {1, 100}},2000},
    {{"C-TÊn Vò-Lv5"    ,{0,149,74,1}, {1, 100}},2000},
    {{"C-Qu¸n Th¹ch-Lv5"    ,{0,149,75,1}, {1, 100}},2000},
    {{"C-Né Ng©m-Lv5"    ,{0,149,76,1}, {1, 100}},2000},
    {{"C-Xuyªn V©n-Lv5"    ,{0,149,77,1}, {1, 100}},2000},
    {{"C-ThÇn Lùc-Lv5"    ,{0,149,78,1}, {1, 100}},2000},
    {{"C-Ng­ng ThÇn-Lv5"    ,{0,149,79,1}, {1, 100}},2000},
    {{"C-V« Gian-Lv5"    ,{0,149,80,1}, {1, 100}},2000},
    {{"C-V« Cùc-Lv5"    ,{0,149,81,1}, {1, 100}},2000},
    {{"C-Cuång NhÉn-Lv5"    ,{0,149,82,1}, {1, 100}},2000},
    {{"C-L¨ng NhuÖ-Lv5"    ,{0,149,83,1}, {1, 100}},2000},
    {{"C-Linh Viªn-Lv5"    ,{0,149,84,1}, {1, 100}},2000},
    {{"C-H¶i VËn-Lv5"    ,{0,149,85,1}, {1, 100}},2000},
    {{"C-H¶i T©m-Lv5"    ,{0,149,86,1}, {1, 100}},2000},
    {{"H-LiÖt Nham-Lv5"    ,{0,148,69,1}, {1, 100}},2000},
    {{"H-Ph¸ Kh«ng-Lv5"    ,{0,148,70,1}, {1, 100}},2000},
    {{"H-Tóy KiÕm-Lv5"    ,{0,148,71,1}, {1, 100}},2000},
    {{"H-TËt Phong-Lv5"    ,{0,148,72,1}, {1, 100}},2000},
    {{"H-TÊn Vò-Lv5"    ,{0,148,73,1}, {1, 100}},2000},
    {{"H-¦ng TËp-Lv5"    ,{0,148,74,1}, {1, 100}},2000},
    {{"H-Linh T©m-Lv5"    ,{0,148,75,1}, {1, 100}},2000},
    {{"H-ThÇn Lùc-Lv5"    ,{0,148,76,1}, {1, 100}},2000},
    {{"H-Ng­ng ThÇn-Lv5"    ,{0,148,77,1}, {1, 100}},2000},
    {{"H-V« Gian-Lv5"    ,{0,148,78,1}, {1, 100}},2000},
    {{"H-V« Cùc-Lv5"    ,{0,148,79,1}, {1, 100}},2000},
    {{"H-Cuång NhÉn-Lv5"    ,{0,148,80,1}, {1, 100}},2000},
    {{"H-L¨ng NhuÖ-Lv5"    ,{0,148,81,1}, {1, 100}},2000},
    {{"H-Linh Viªn-Lv5"    ,{0,148,82,1}, {1, 100}},2000},
    {{"H-H¶i VËn-Lv5"    ,{0,148,83,1}, {1, 100}},2000},
    {{"H-H¶i T©m-Lv5"    ,{0,148,84,1}, {1, 100}},2000},
    {{"T-LiÖt Nham-Lv5"    ,{0,150,69,1}, {1, 100}},2000},
    {{"T-Ph¸ Kh«ng-Lv5"    ,{0,150,70,1}, {1, 100}},2000},
    {{"T-Tóy KiÕm-Lv5"    ,{0,150,71,1}, {1, 100}},2000},
    {{"T-TËt Phong-Lv5"    ,{0,150,72,1}, {1, 100}},2000},
    {{"T-TÊn Vò-Lv5"    ,{0,150,73,1}, {1, 100}},2000},
    {{"T-V« L­îng-Lv5"    ,{0,150,74,1}, {1, 100}},2000},
    {{"T-Môc Minh-Lv5"    ,{0,150,75,1}, {1, 100}},2000},
    {{"T-ThÇn Lùc-Lv5"    ,{0,150,76,1}, {1, 100}},2000},
    {{"T-Ng­ng ThÇn-Lv5"    ,{0,150,77,1}, {1, 100}},2000},
    {{"T-V« Gian-Lv5"    ,{0,150,78,1}, {1, 100}},2000},
    {{"T-V« Cùc-Lv5"    ,{0,150,79,1}, {1, 100}},2000},
    {{"T-Cuång NhÉn-Lv5"    ,{0,150,80,1}, {1, 100}},2000},
    {{"T-L¨ng NhuÖ-Lv5"    ,{0,150,81,1}, {1, 100}},2000},
    {{"T-Linh Viªn-Lv5"    ,{0,150,82,1}, {1, 100}},2000},
    {{"T-H¶i VËn-Lv5"    ,{0,150,83,1}, {1, 100}},2000},
    {{"T-H¶i T©m-Lv5"    ,{0,150,84,1}, {1, 100}},2000},
}

tYunLingLv6 = {
    {{"T-LiÖt Nham-Lv6"    ,{0,150,85,1}, {1, 100}},3000},
    {{"T-Ph¸ Kh«ng-Lv6"    ,{0,150,86,1}, {1, 100}},3000},
    {{"T-Tóy KiÕm-Lv6"    ,{0,150,87,1}, {1, 100}},2000},
    {{"T-TËt Phong-Lv6"    ,{0,150,88,1}, {1, 100}},2000},
    {{"T-TÊn Vò-Lv6"    ,{0,150,89,1}, {1, 100}},2000},
    {{"T-V« L­îng-Lv6"    ,{0,150,90,1}, {1, 100}},2000},
    {{"T-Môc Minh-Lv6"    ,{0,150,91,1}, {1, 100}},2000},
    {{"T-ThÇn Lùc-Lv6"    ,{0,150,92,1}, {1, 100}},2000},
    {{"T-Ng­ng ThÇn-Lv6"    ,{0,150,93,1}, {1, 100}},2000},
    {{"T-V« Gian-Lv6"    ,{0,150,94,1}, {1, 100}},2000},
    {{"T-V« Cùc-Lv6"    ,{0,150,95,1}, {1, 100}},2000},
    {{"T-Cuång NhÉn-Lv6"    ,{0,150,96,1}, {1, 100}},2000},
    {{"T-L¨ng NhuÖ-Lv6"    ,{0,150,97,1}, {1, 100}},2000},
    {{"T-Linh Viªn-Lv6"    ,{0,150,98,1}, {1, 100}},2000},
    {{"T-H¶i VËn-Lv6"    ,{0,150,99,1}, {1, 100}},2000},
    {{"T-H¶i T©m-Lv6"    ,{0,150,100,1}, {1, 100}},2000},
    {{"H-LiÖt Nham-Lv6"    ,{0,148,85,1}, {1, 100}},2000},
    {{"H-Ph¸ Kh«ng-Lv6"    ,{0,148,86,1}, {1, 100}},2000},
    {{"H-Tóy KiÕm-Lv6"    ,{0,148,87,1}, {1, 100}},2000},
    {{"H-TËt Phong-Lv6"    ,{0,148,88,1}, {1, 100}},2000},
    {{"H-TÊn Vò-Lv6"    ,{0,148,89,1}, {1, 100}},2000},
    {{"H-¦ng TËp-Lv6"    ,{0,148,90,1}, {1, 100}},2000},
    {{"H-Linh T©m-Lv6"    ,{0,148,91,1}, {1, 100}},2000},
    {{"H-ThÇn Lùc-Lv6"    ,{0,148,92,1}, {1, 100}},2000},
    {{"H-Ng­ng ThÇn-Lv6"    ,{0,148,93,1}, {1, 100}},2000},
    {{"H-V« Gian-Lv6"    ,{0,148,94,1}, {1, 100}},2000},
    {{"H-V« Cùc-Lv6"    ,{0,148,95,1}, {1, 100}},2000},
    {{"H-Cuång NhÉn-Lv6"    ,{0,148,96,1}, {1, 100}},2000},
    {{"H-L¨ng NhuÖ-Lv6"    ,{0,148,97,1}, {1, 100}},2000},
    {{"H-Linh Viªn-Lv6"    ,{0,148,98,1}, {1, 100}},2000},
    {{"H-H¶i VËn-Lv6"    ,{0,148,99,1}, {1, 100}},2000},
    {{"H-H¶i T©m-Lv6"    ,{0,148,100,1}, {1, 100}},2000},
    {{"C-LiÖt Nham-Lv6"    ,{0,149,87,1}, {1, 100}},2000},
    {{"C-Ph¸ Kh«ng-Lv6"    ,{0,149,88,1}, {1, 100}},2000},
    {{"C-Tóy KiÕm-Lv6"    ,{0,149,89,1}, {1, 100}},2000},
    {{"C-TËt Phong-Lv6"    ,{0,149,90,1}, {1, 100}},2000},
    {{"C-TÊn Vò-Lv6"    ,{0,149,91,1}, {1, 100}},2000},
    {{"C-Qu¸n Th¹ch-Lv6"    ,{0,149,92,1}, {1, 100}},2000},
    {{"C-Né Ng©m-Lv6"    ,{0,149,93,1}, {1, 100}},2000},
    {{"C-Xuyªn V©n-Lv6"    ,{0,149,94,1}, {1, 100}},2000},
    {{"C-ThÇn Lùc-Lv6"    ,{0,149,95,1}, {1, 100}},2000},
    {{"C-Ng­ng ThÇn-Lv6"    ,{0,149,96,1}, {1, 100}},2000},
    {{"C-V« Gian-Lv6"    ,{0,149,97,1}, {1, 100}},2000},
    {{"C-V« Cùc-Lv6"    ,{0,149,98,1}, {1, 100}},2000},
    {{"C-Cuång NhÉn-Lv6"    ,{0,149,99,1}, {1, 100}},2000},
    {{"C-L¨ng NhuÖ-Lv6"    ,{0,149,100,1}, {1, 100}},2000},
    {{"C-Linh Viªn-Lv6"    ,{0,149,101,1}, {1, 100}},2000},
    {{"C-H¶i VËn-Lv6"    ,{0,149,102,1}, {1, 100}},2000},
    {{"C-H¶i T©m-Lv6"    ,{0,149,103,1}, {1, 100}},2000},
}

tYunLing = {
	[4] = tYunLingLv4,
	[5] = tYunLingLv5,
	[6] = tYunLingLv6,
}

function randYunLing4(tPara, szMsgTitle)
	randYunLing(4,tPara, szMsgTitle)
end
function randYunLing5(tPara, szMsgTitle)
	randYunLing(5,tPara, szMsgTitle)
end
function randYunLing6(tPara, szMsgTitle)
	randYunLing(6,tPara, szMsgTitle)
end

function randYunLing(nLevel,tPara, szMsgTitle)
	local t = tYunLing[nLevel]
	if t then
		return _MA_GiveRandItem(t, tPara, szMsgTitle, 1)
	end
end

tRingLingTu = {
    {{"Linh §å T¶ §µ Giíi ChØ"    ,{0,102,30221,1}, {1, 100}},5000},
    {{"Linh §å H÷u §µ Giíi ChØ"    ,{0,102,30222,1}, {1, 100}},5000},
}
function randRingLingTu(tPara, szMsgTitle)
	return _MA_GiveRandItem(tRingLingTu, tPara, szMsgTitle, 1)
end

tRingHaoXia = {
    {{"Hµo HiÖp Lùc L­îng Giíi"    ,{0,102,30223,1}, {1, 100}},2000},
    {{"Hµo HiÖp Néi C«ng Giíi"    ,{0,102,30224,1}, {1, 100}},2000},
    {{"Hµo HiÖp C¨n Cèt Giíi"    ,{0,102,30225,1}, {1, 100}},2000},
    {{"Hµo HiÖp Th©n Ph¸p Giíi"    ,{0,102,30226,1}, {1, 100}},2000},
    {{"Hµo HiÖp §ång S¸t Giíi"    ,{0,102,30227,1}, {1, 100}},2000},
}
function randRingHaoXia(tPara,szMsgTitle)
	return _MA_GiveRandItem(tRingHaoXia, tPara, szMsgTitle, 1)
end

--±ÈÎä´ó»á±¦Ïä
tBWDHBox_Free = {
	nNeedRoom = 1,
	tFix= {
		{2,1000000,1},
	},
	tRand = {
    	{{"C©y b¸t nh· nhá"    ,{2,0,504,1,4}, nil,nil, {1, 100}},500},
        {{"C©y B¸t Nh·"    ,{2,0,398,1,4}, nil,nil, {1, 100}},500},
        {{"Th¸nh VËt S­ M«n"    ,{2,1,30311,1,4}, 7,nil, {1, 100}},500},
        {{"TiÓu truyÒn c«ng ®¬n"    ,{2,1,30312,1,4}, 7,nil, {1, 100}},1000},
        {{"TruyÒn C«ng §¬n"    ,{2,1,30313,1,4}, 7,nil, {1, 100}},1000},
        {{"TruyÒn C«ng Kim §¬n"    ,{2,1,30688,1,4}, 7,nil, {1, 100}},1000},
        {{"Vâ l©m b¸o míi"    ,{2,1,30314,1,4}, 7,nil, {1, 100}},500},
        {{"M¶nh Tu Ch©n YÕu QuyÕt"    ,{2,1,30315,1,4}, 7,nil, {1, 100}},1000},
        {{"VÐ TiÕu Y B¹c"    ,{2,1,30492,1,4}, nil,nil, {1, 100}},500},
        {{"VÐ TiÕu Y §ång"    ,{2,1,30493,1,4}, nil,nil, {1, 100}},1000},
        {{randYunLing4, {1, 4, 7, nil}}, 480},
        {{randYunLing5, {1, 4, 7, nil}}, 10},
        {{randRingLingTu, {1, 4, nil, nil}}, 10},
        {{"Tiªn ¢m Th¹ch"    ,{2,1,30674,1}, nil,nil, {1, 100}},2000},
	},
}

tBWDHBox_IB = {
	nNeedRoom = 2,
	tRequire = {"Thiªn Kiªu LÖnh",2, 97, 236,1},
	tFix= {
		{2,2000000,1},
		{1,"Tiªn ¢m Th¹ch",{2,1,30674,1},0,1},
	},
	tRand = {
        {{"C©y b¸t nh· nhá"    ,{2,0,504,1}, nil,nil, {1, 100}},500},
        {{"C©y B¸t Nh·"    ,{2,0,398,1}, nil,nil, {1, 100}},500},
        {{"Th¸nh VËt S­ M«n"    ,{2,1,30311,1}, 7,nil, {1, 100}},500},
        {{"TiÓu truyÒn c«ng ®¬n"    ,{2,1,30312,1}, 7,nil, {1, 100}},500},
        {{"TruyÒn C«ng §¬n"    ,{2,1,30313,1}, 7,nil, {1, 100}},500},
        {{"TruyÒn C«ng Kim §¬n"    ,{2,1,30688,1}, 7,nil, {1, 100}},900},
        {{"Vâ l©m b¸o míi"    ,{2,1,30314,1}, 7,nil, {1, 100}},500},
        {{"M¶nh Tu Ch©n YÕu QuyÕt"    ,{2,1,30315,1}, 7,nil, {1, 100}},500},
        {{"VÐ TiÕu Y §ång"    ,{2,1,30493,1}, nil,nil, {1, 100}},800},
        {{"VÐ TiÕu Y B¹c"    ,{2,1,30492,1}, nil,nil, {1, 100}},500},
        {{"VÐ TiÕu Y Vµng"    ,{2,1,30491,1}, nil,nil, {1, 100}},200},
        {{randYunLing4, {1, nil, 7, nil}}, 900},
        {{randYunLing5, {1, nil, 7, nil}}, 500},
        {{randYunLing6, {1, nil, 7, 1}}, 50},
        {{randRingLingTu, {1, nil, nil, nil}}, 100},
        {{"Tiªn ¢m Th¹ch"    ,{2,1,30674,1}, nil,nil, {1, 100}},2550},
        --{{randRingHaoXia, {1, nil, nil, 1}}, 0.5},
	},
    
}

--Ê¦ÃÅ·âÉÍ±¦Ïä
tFactionBox_Free = {
	nNeedRoom = 2,
	tFix={
		{2,5000000,1},
		{1,"Tiªn ¢m Th¹ch",{2,1,30674,10},0,1},
	},
	tRand = {
        {{"C©y b¸t nh· nhá"    ,{2,0,504,1,4}, nil,nil, {1, 100}},500},
        {{"C©y B¸t Nh·"    ,{2,0,398,1,4}, nil,nil, {1, 100}},500},
        {{"Th¸nh VËt S­ M«n"    ,{2,1,30311,1,4}, 7,nil, {1, 100}},500},
        {{"TiÓu truyÒn c«ng ®¬n"    ,{2,1,30312,1,4}, 7,nil, {1, 100}},500},
        {{"TruyÒn C«ng §¬n"    ,{2,1,30313,1,4}, 7,nil, {1, 100}},500},
        {{"TruyÒn C«ng Kim §¬n"    ,{2,1,30688,1,4}, 7,nil, {1, 100}},900},
        {{"Vâ l©m b¸o míi"    ,{2,1,30314,1,4}, 7,nil, {1, 100}},500},
        {{"M¶nh Tu Ch©n YÕu QuyÕt"    ,{2,1,30315,1,4}, 7,nil, {1, 100}},500},
        {{"VÐ TiÕu Y §ång"    ,{2,1,30493,1,4}, nil,nil, {1, 100}},800},
        {{"VÐ TiÕu Y B¹c"    ,{2,1,30492,1,4}, nil,nil, {1, 100}},1000},
        {{"VÐ TiÕu Y Vµng"    ,{2,1,30491,1,4}, nil,nil, {1, 100}},245},
        {{randYunLing4, {1, 4, 7, nil}}, 1000},
        {{randYunLing5, {1, 4, 7, nil}}, 100},
        {{randYunLing6, {1, 4, 7, 1}}, 50},
        {{randRingLingTu, {1, 4, nil, nil}}, 400},
        {{"Tiªn ¢m Th¹ch"    ,{2,1,30674,10}, nil,nil, {1, 100}},2005},
        --{{randRingHaoXia, {1, nil, nil, 1}}, 1},
	},
}

tFactionBox_IB = {
	nNeedRoom = 2,
	tRequire = {"Thiªn Kiªu LÖnh",2, 97, 236,10},
	tFix = {
		{2,10000000,1},
		{1,"Tiªn ¢m Th¹ch",{2,1,30674,20},0,1},
	},
	tRand = {
        {{"C©y b¸t nh· nhá"    ,{2,0,504,1}, nil,nil, {1, 100}},500},
        {{"C©y B¸t Nh·"    ,{2,0,398,1}, nil,nil, {1, 100}},500},
        {{"Th¸nh VËt S­ M«n"    ,{2,1,30311,1}, 7,nil, {1, 100}},500},
        {{"TiÓu truyÒn c«ng ®¬n"    ,{2,1,30312,1}, 7,nil, {1, 100}},500},
        {{"TruyÒn C«ng §¬n"    ,{2,1,30313,1}, 7,nil, {1, 100}},500},
        {{"TruyÒn C«ng Kim §¬n"    ,{2,1,30688,1}, 7,nil, {1, 100}},900},
        {{"Vâ l©m b¸o míi"    ,{2,1,30314,1}, 7,nil, {1, 100}},500},
        {{"M¶nh Tu Ch©n YÕu QuyÕt"    ,{2,1,30315,1}, 7,nil, {1, 100}},500},
        {{"VÐ TiÕu Y §ång"    ,{2,1,30493,1}, nil,nil, {1, 100}},1000},
        {{"VÐ TiÕu Y B¹c"    ,{2,1,30492,1}, nil,nil, {1, 100}},500},
        {{"VÐ TiÕu Y Vµng"    ,{2,1,30491,1}, nil,nil, {1, 100}},200},
        {{randYunLing4, {1, nil, 7, nil}}, 800},
        {{randYunLing5, {1, nil, 7, nil}}, 600},
        {{randYunLing6, {1, nil, 7, 1}}, 300},
        {{randRingLingTu, {1, nil, nil, nil}}, 200},
        {{"Tiªn ¢m Th¹ch"    ,{2,1,30674,20}, nil,nil, {1, 100}},2000},
        --{{randRingHaoXia, {1, nil, nil, 1}}, 50},
	},
}

tChuanGongJinDan_IB = {
	nNeedRoom = 1,
	tRequire = {"Hu©n ch­¬ng anh hïng",2, 1, 30499,1},
	tFix = {
		{2,1000000,1},
	},
}

T_BOX = {
	[30692] = {tBWDHBox_Free, tBWDHBox_IB},				--±ÈÎä´ó»á±¦Ïä
	[30693] = {tFactionBox_Free, tFactionBox_IB},		--Ê¦ÃÅ·âÉÍ±¦Ïä
	[30688] = {tChuanGongJinDan_IB},				--´«¹¦½ðµ¤
}

function OnUse(nItemIndex)
	onUse_Confirm(nItemIndex, 0)
end

function onUse_Confirm(nItemIndex, bConfirm)
	if GetItemGenre(nItemIndex)== ITEM_G and GetItemDetail(nItemIndex)==ITEM_D then
		local nP = GetItemParticular(nItemIndex)
		local tCfg = T_BOX[nP]
		if tCfg then
			if getn(tCfg) > 1 then
				Say(format("[%s] cã %d c¸ch më.",GetItemName(nItemIndex),getn(tCfg)),
    				3,
    				format("\nMë miÔn phÝ/#onUse_Real(%d,%d,%d)", nItemIndex, 1, 0),
    				format("\nDïng ®¹o cô më/#onUse_Real(%d,%d,%d)", nItemIndex, 2, 0),
    				"\nBá qua/nothing");
				return
			elseif getn(tCfg) == 1 then
				onUse_Real(nItemIndex, 1, 0)
				return
			end
		end
	end
end

function onUse_Real(nItemIndex, nOpenIndex, bConfirm)
	if GetItemGenre(nItemIndex)== ITEM_G and GetItemDetail(nItemIndex)==ITEM_D then
		local nP = GetItemParticular(nItemIndex)
		local tCfg = T_BOX[nP]
		if tCfg then
			local tNeed = tCfg[nOpenIndex].tRequire
			if tNeed and 1~= bConfirm then
				Say(format("Më [%s] cÇn <color=yellow>%d [%s]<color>, ®ång ý më kh«ng?",GetItemName(nItemIndex),tNeed[5], tNeed[1]),
    			2,
    			format("\n x¸c nhËn më/#onUse_Real(%d,%d,%d)", nItemIndex, nOpenIndex, 1),
    			"\nBá qua/nothing");
				return
			end
			local szFunc = format("onInputNumCallBack_%d_%d",nP, nOpenIndex)
			local nMax = GetItemCount(ITEM_G, ITEM_D, nP)
			AskClientForNumber(szFunc, 1, nMax, "Muèn më mÊy c¸i?")
		end
	end
end

function onInputNumCallBack_30692_1(nNum)
	onOpenBoxReal(nNum,30692,1)
end
function onInputNumCallBack_30692_2(nNum)
	onOpenBoxReal(nNum,30692,2)
end
function onInputNumCallBack_30693_1(nNum)
	onOpenBoxReal(nNum,30693,1)
end
function onInputNumCallBack_30693_2(nNum)
	onOpenBoxReal(nNum,30693,2)
end
function onInputNumCallBack_30688_1(nNum)
	onOpenBoxReal(nNum,30688,1)
end

function onOpenBoxReal(nNum, nParticular, nOpenIndex)
	local tCfg = T_BOX[nParticular]
	if tCfg then
		for i=1,nNum do
			if 1 ~= onOpenBoxReal_Once(nParticular, nOpenIndex) then
				break
			end
		end
	end
end

T_RUNTIME_STAT = {
	[30692] = {20, 5, },				--±ÈÎä´ó»á±¦Ïä
	[30693] = {20, 7, },		--Ê¦ÃÅ·âÉÍ±¦Ïä
}

function onOpenBoxReal_Once(nParticular, nOpenIndex)
	local tCfg = T_BOX[nParticular]
	if tCfg then
		local tAward = tCfg[nOpenIndex]
		if tAward then
			local tNeed = tAward.tRequire
			if gf_JudgeRoomWeight(tAward.nNeedRoom, 100, "") ~= 1 then return end
			if tNeed  then
				if GetItemCount(tNeed[2], tNeed[3], tNeed[4]) < tNeed[5] then
					Talk(1, "", format("%s kh«ng ®ñ %d c¸i", tNeed[1], tNeed[5]))
					return 0
				end
				if DelItem(tNeed[2],tNeed[3],tNeed[4],tNeed[5]) ~= 1 then
					return 0
				end
--				Observer:onEvent(SYSEVENT_GLOBAL_COST_IB, {tNeed[2],tNeed[3],tNeed[4],tNeed[5]})
			end
			if DelItem(ITEM_G, ITEM_D,nParticular,1) ~= 1 then
				return 0
			end
			local tFixAward = tAward.tFix
			local szItemName = GetItemName(ITEM_G, ITEM_D,nParticular)
			local szLog = format("R­¬ng %s",szItemName,ITEM_G, ITEM_D,nParticular)
			if tFixAward then
				gf_EventGiveAllAward(tFixAward,"Më r­¬ng",szLog,nil);
			end
			local tRandAward = tAward.tRand
			if tRandAward then
				_MissionAward_RandAward(tRandAward, szLog)
			end
			
			local tStat = T_RUNTIME_STAT[nParticular]
			if tStat then
				AddRuntimeStat(tStat[1], tStat[2], nOpenIndex - 1, 1)
			end
			return 1
		end
	end
	return 0
end

function nothing()
end
