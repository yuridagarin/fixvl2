--åÐÒ£ºÐ
--authored by pengbo
Suit_be_date_num = 30

tWenkui_cloth = {
	{  --±ê×¼ÄÐ
		{"V¨n CÈm Bµo 1",259},{"V¨n CÈm Bµo 1",260}
	},
	{  --¿ýÎàÄÐ
		{"V¨n CÈm Bµo 2",261},{"V¨n CÈm Bµo 2",262}
	},
	{  --ÐÔ¸ÐÅ®
		{"V¨n CÈm Th­êng (§á)",263},{"V¨n CÈm Th­êng (Hång)",264},{"V¨n CÈm Th­êng (Xanh L¸)",265},{"V¨n CÈm Th­êng (Xanh D­¬ng)",266},
		{"V¨n CÈm Th­êng (Vµng)",267},{"V¨n CÈm Th­êng (Cam)",268},{"V¨n CÈm Th­êng (§en)",269}
	},
	{  --½¿Ð¡Å®
		{"V¨n CÈm Th­êng (§á)",270},{"V¨n CÈm Th­êng (Hång)",271},{"V¨n CÈm Th­êng (Xanh L¸)",272},{"V¨n CÈm Th­êng (Xanh D­¬ng)",273},
		{"V¨n CÈm Th­êng (Vµng)",274},{"V¨n CÈm Th­êng (Cam)",275},{"V¨n CÈm Th­êng (§en)",276}	
	},
}

tXiaoyao_cloth = {
		{  --±ê×¼ÄÐ    -Í·,ÒÂ·þ,¿ã×Ó
			{{"Ngo¹i trang tiªu dao (n©u)",437},{"Ngo¹i trang tiªu dao (lôc)",431},{"Ngo¹i trang tiªu dao (tÝm)",419},{"Ngo¹i trang tiªu dao (lam)",425},{"Ngo¹i trang tiªu dao (®en)",413}}, --ÉÙÁÖ
			{{"Ngo¹i trang tiªu dao (n©u)",440},{"Ngo¹i trang tiªu dao (lôc)",434},{"Ngo¹i trang tiªu dao (tÝm)",422},{"Ngo¹i trang tiªu dao (lam)",428},{"Ngo¹i trang tiªu dao (®en)",416}}, --ÌÆÃÅ
			{{"Ngo¹i trang tiªu dao (n©u)",439},{"Ngo¹i trang tiªu dao (lôc)",433},{"Ngo¹i trang tiªu dao (tÝm)",421},{"Ngo¹i trang tiªu dao (lam)",427},{"Ngo¹i trang tiªu dao (®en)",415}}, --Ø¤°ï
			{{"Ngo¹i trang tiªu dao (n©u)",438},{"Ngo¹i trang tiªu dao (lôc)",432},{"Ngo¹i trang tiªu dao (tÝm)",420},{"Ngo¹i trang tiªu dao (lam)",426},{"Ngo¹i trang tiªu dao (®en)",414}}, --Îäµ±
			{{"Ngo¹i trang tiªu dao (n©u)",441},{"Ngo¹i trang tiªu dao (lôc)",435},{"Ngo¹i trang tiªu dao (tÝm)",423},{"Ngo¹i trang tiªu dao (lam)",429},{"Ngo¹i trang tiªu dao (®en)",417}}, --ÑîÃÅ
			{{"Ngo¹i trang tiªu dao (n©u)",442},{"Ngo¹i trang tiªu dao (lôc)",436},{"Ngo¹i trang tiªu dao (tÝm)",424},{"Ngo¹i trang tiªu dao (lam)",430},{"Ngo¹i trang tiªu dao (®en)",418}}, --Îå¶¾
			{{"Ngo¹i trang tiªu dao (n©u)",481},{"Ngo¹i trang tiªu dao (lôc)",479},{"Ngo¹i trang tiªu dao (tÝm)",475},{"Ngo¹i trang tiªu dao (lam)",477},{"Ngo¹i trang tiªu dao (®en)",473}}, --ÎÞÃÅÎÞÅÉ
		},
		{  --¿ýÎàÄÐ
			{{"Ngo¹i trang tiªu dao (n©u)",467},{"Ngo¹i trang tiªu dao (lôc)",461},{"Ngo¹i trang tiªu dao (tÝm)",449},{"Ngo¹i trang tiªu dao (lam)",455},{"Ngo¹i trang tiªu dao (®en)",443}}, --ÉÙÁÖ
			{{"Ngo¹i trang tiªu dao (n©u)",470},{"Ngo¹i trang tiªu dao (lôc)",464},{"Ngo¹i trang tiªu dao (tÝm)",452},{"Ngo¹i trang tiªu dao (lam)",458},{"Ngo¹i trang tiªu dao (®en)",446}}, --ÌÆÃÅ
			{{"Ngo¹i trang tiªu dao (n©u)",469},{"Ngo¹i trang tiªu dao (lôc)",463},{"Ngo¹i trang tiªu dao (tÝm)",451},{"Ngo¹i trang tiªu dao (lam)",457},{"Ngo¹i trang tiªu dao (®en)",445}}, --Ø¤°ï
			{{"Ngo¹i trang tiªu dao (n©u)",468},{"Ngo¹i trang tiªu dao (lôc)",462},{"Ngo¹i trang tiªu dao (tÝm)",450},{"Ngo¹i trang tiªu dao (lam)",456},{"Ngo¹i trang tiªu dao (®en)",444}}, --Îäµ±
			{{"Ngo¹i trang tiªu dao (n©u)",471},{"Ngo¹i trang tiªu dao (lôc)",465},{"Ngo¹i trang tiªu dao (tÝm)",453},{"Ngo¹i trang tiªu dao (lam)",459},{"Ngo¹i trang tiªu dao (®en)",447}}, --ÑîÃÅ
			{{"Ngo¹i trang tiªu dao (n©u)",472},{"Ngo¹i trang tiªu dao (lôc)",466},{"Ngo¹i trang tiªu dao (tÝm)",454},{"Ngo¹i trang tiªu dao (lam)",460},{"Ngo¹i trang tiªu dao (®en)",448}}, --Îå¶¾
			{{"Ngo¹i trang tiªu dao (n©u)",482},{"Ngo¹i trang tiªu dao (lôc)",480},{"Ngo¹i trang tiªu dao (tÝm)",476},{"Ngo¹i trang tiªu dao (lam)",478},{"Ngo¹i trang tiªu dao (®en)",474}}, --ÎÞÃÅÎÞÅÉ
		},
		{  --ÐÔ¸ÐÅ®
			{"Tö Hµ Lôc (sen lôc)",408,408,208},{"La Lan Tö (tÝm than)",409,409,209},{"B¨ng H¶i Lam (xanh biÓn)",410,410,210},{"Méng C¶nh PhÊn (hång)",411,411,211},{"Mai Quý Hång (®á)",412,412,212}
		},
		{  --½¿Ð¡Å®
		  {"NgÉu Hµ Lôc (sen lôc)",398,398,198},{"La Lan Tö (tÝm than)",399,399,199},{"B¨ng H¶i Lam (xanh biÓn)",400,400,200},{"Méng C¶nh PhÊn (hång)",401,401,201},{"Mai Quý Hång (®á)",402,402,202}
		}
}

function OnUse(nItemIdx)
	local player_sex = GetBody()
	local tSay = {}
	if player_sex < 3 then
			Say("<color=green>Tiªu Dao Hép<color>: §¹i hiÖp cÇn ngo¹i trang g×?",3,
		"Ta cÇn V¨n CÈm Bµo/#give_wenkui("..nItemIdx..")",
		"Ta cÇn ngo¹i trang Tiªu Dao/#give_xiaoyao("..nItemIdx..")",
		"Ta sÏ chän ngo¹i trang sau/leave"
					)
	else
		Say("<color=green>Tiªu Dao Hép<color>: §¹i hiÖp cÇn ngo¹i trang g×?",3,
			"Ta cÇn ngo¹i trang Tiªu Dao/#give_xiaoyao("..nItemIdx..")",
			"Ta cÇn ngo¹i trang T©n Niªn/#give_tannien("..nItemIdx..")",
			"Ta sÏ chän ngo¹i trang sau/leave"
				)
	end
end

function give_tannien(nItemIdx)
	local player_sex = GetBody()
	local nExpireTime = tonumber(GetItemExpireTime(nItemIdx))
	if DelItemByIndex(nItemIdx,1) == 1 then
		if player_sex == 1 then
			local add_flag,goods_index = AddItem(0,109,113,1)
			SetItemExpireTime(goods_index, nExpireTime)
			return
		elseif player_sex == 2 then
			local add_flag,goods_index = AddItem(0,109,114,1)
			SetItemExpireTime(goods_index, nExpireTime)
			return
		elseif player_sex == 3 then
			local add_flag,goods_index = AddItem(0,109,116,1)
			SetItemExpireTime(goods_index, nExpireTime)
			return
		elseif player_sex == 4 then
			local add_flag,goods_index = AddItem(0,109,115,1)
			SetItemExpireTime(goods_index, nExpireTime)
			return
		end
	end
end

function give_wenkui(nItemIdx)
	local player_sex = GetBody()
	local tSay = {}
	for i = 1,getn(tWenkui_cloth[player_sex]) do
		tinsert(tSay,tWenkui_cloth[player_sex][i][1].."/#wk_give_cloth("..tWenkui_cloth[player_sex][i][2]..", "..nItemIdx..")")
	end
	tinsert(tSay,"Trë vÒ trang tr­íc/#end_say("..nItemIdx..")")
	Say("<color=green>Tiªu Dao Hép<color>: §¹i hiÖp cÇn lo¹i ngo¹i trang nµo?",getn(tSay),tSay)
end

function wk_give_cloth(nDetail, nItemIdx)
	local nExpireTime = tonumber(GetItemExpireTime(nItemIdx))
	if GetFreeItemRoom() < 1 or (GetMaxItemWeight() - GetCurItemWeight()) < 30 then
		Say("<color=green>Tiªu Dao Hép<color>Hµnh trang kh«ng ®ñ chç, xin s¾p xÕp l¹i!",0)
		return
	end
	if DelItemByIndex(nItemIdx,1) == 1 then
		local add_flag,goods_index = AddItem(0,109,nDetail,1)
		SetItemExpireTime(goods_index, nExpireTime)
	end
end
function give_xiaoyao(nItemIdx)
	local player_sex = GetBody()
	local player_route = GetPlayerRoute()
	local tSay = {}
	local choice = 0
	if player_route == 0 then
		choice = 7
	elseif player_route < 5 then
		choice = 1
	elseif player_route < 7 then
		choice = 2
	elseif player_route < 13 then
		choice = 3
	elseif player_route < 16 then
		choice = 4
	elseif player_route < 19 then
		choice = 5
	else
		choice = 6
	end
	if player_sex < 3 then
		for i = 1,5 do
			tinsert(tSay,tXiaoyao_cloth[player_sex][1][i][1].."/#xy_give_cloth("..tXiaoyao_cloth[player_sex][choice][i][2]..", "..nItemIdx..")")
		end
		tinsert(tSay,"Trë vÒ trang tr­íc/#end_say("..nItemIdx..")")
		Say("<color=green>Tiªu Dao Hép<color>: §¹i hiÖp cÇn lo¹i ngo¹i trang nµo?",getn(tSay),tSay)
	else 
		for i = 1,5 do
			tinsert(tSay,tXiaoyao_cloth[player_sex][i][1].."/#xy_give_cloth1("..tXiaoyao_cloth[player_sex][i][2]..", "..nItemIdx..")")
		end
		tinsert(tSay,"Trë vÒ trang tr­íc/#end_say("..nItemIdx..")")
		Say("<color=green>Tiªu Dao Hép<color>: §¹i hiÖp cÇn lo¹i ngo¹i trang nµo?",getn(tSay),tSay)
	end
end

function xy_give_cloth(nIndex, nItemIdx)
	local player_route = GetPlayerRoute()
	local nExpireTime = tonumber(GetItemExpireTime(nItemIdx))
	if GetFreeItemRoom() < 3 or (GetMaxItemWeight() - GetCurItemWeight()) < 30 then
		Say("<color=green>Tiªu Dao Hép<color>Hµnh trang kh«ng ®ñ chç, xin s¾p xÕp l¹i!",0)
		return
	end
	if player_route == 0 then
		if DelItemByIndex(nItemIdx,1) == 1  then
			local add_flag,goods_index = AddItem(0,109,nIndex,1)
			SetItemExpireTime(goods_index, nExpireTime)
		end		
	else
		if DelItemByIndex(nItemIdx,1) == 1  then
			local add_flag,goods_index = AddItem(0,108,nIndex,1)
			SetItemExpireTime(goods_index, nExpireTime)
			add_flag,goods_index = AddItem(0,109,nIndex,1)
			SetItemExpireTime(goods_index, nExpireTime)
		end		
	end
end

function xy_give_cloth1(nIndex, nItemIdx)
	local nExpireTime = tonumber(GetItemExpireTime(nItemIdx))
	if GetFreeItemRoom() < 3 or (GetMaxItemWeight() - GetCurItemWeight()) < 30 then
		Say("<color=green>Tiªu Dao Hép<color>Hµnh trang kh«ng ®ñ chç, xin s¾p xÕp l¹i!",0)
		return
	end
	if DelItemByIndex(nItemIdx,1) == 1  then
		local add_flag,goods_index = AddItem(0,108,nIndex,1)
		SetItemExpireTime(goods_index, nExpireTime)
		add_flag,goods_index = AddItem(0,109,nIndex,1)
		SetItemExpireTime(goods_index, nExpireTime)
		add_flag,goods_index = AddItem(0,110,nIndex-200,1)
		SetItemExpireTime(goods_index, nExpireTime)
	end
end

function end_say(nItemIdx)
	return OnUse(nItemIdx)
end

function leave()

end