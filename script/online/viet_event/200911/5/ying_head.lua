Include("\\script\\lib\\globalfunctions.lua");

TSK_YING_AWARD = 2539

tb_ying_award = {
				[78] = {3000,   3000, 50000,   1},
				[79] = {5000,   5000, 50000,   2},
				[80] = {6000,   5000, 50000,   3},
				[81] = {7000,   5000, 50000,   4},
				[82] = {9000,   6000, 50000,   5},
				[83] = {9000,   6000, 50000,   6},
				[84] = {10000, 7000, 50000,   7},
				[85] = {10000, 7000, 50000,   8},
				[86] = {10000, 8000, 60000,   9},
				[87] = {10000, 8000, 70000, 10},
				[88] = {10000, 9000, 80000, 11},
};

tb_ying_yue = {
				[2] = {"Tói bÝ kiÕp ThiÕu L©m", {2, 0, 607, 1, 4}},
				[3] = {"Tói bÝ kiÕp ThiÕu L©m", {2, 0, 607, 1, 4}},
				[4] = {"Tói bÝ kiÕp ThiÕu L©m", {2, 0, 607, 1, 4}},
				[6] = {"Tói bÝ kiÕp §­êng M«n", {2, 0, 608, 1, 4}},
				[8] = {"Tói bÝ kiÕp Nga My", {2, 0, 609, 1, 4}},
				[9] = {"Tói bÝ kiÕp Nga My", {2, 0, 609, 1, 4}},
				[11] = {"Tói bÝ kiÕp C¸i Bang", {2, 0, 610, 1, 4}},
				[12] = {"Tói bÝ kiÕp C¸i Bang", {2, 0, 610, 1, 4}},
				[14] = {"Tói bÝ kiÕp Vâ §ang", {2, 0, 611, 1, 4}},
				[15] = {"Tói bÝ kiÕp Vâ §ang", {2, 0, 611, 1, 4}},
				[17] = {"Tói bÝ kiÕp D­¬ng M«n", {2, 0, 612, 1, 4}},
				[18] = {"Tói bÝ kiÕp D­¬ng M«n", {2, 0, 612, 1, 4}},
				[20] = {"Tói bÝ kiÕp Ngò §éc", {2, 0, 613, 1, 4}},
				[21] = {"Tói bÝ kiÕp Ngò §éc", {2, 0, 613, 1, 4}}
};

tb_ying_book_high = {
				[2] = {"DÞch C©n Kinh-th­îng", {2, 1, 916, 1}},
				[4] = {"Nh­ Lai ThÇn Ch­ëng-th­îng", {2, 1, 919, 1}},
				[3] = {"TÈy Tñy Kinh-th­îng", {2, 1, 922, 1}},
				[6] = {"HÊp Tinh TrËn-th­îng", {2, 1, 925, 1}},
				[8] = {"V¹n T­íng ThÇn C«ng-th­îng", {2, 1, 928, 1}},
				[9] = {"Thiªn ¢m TrÊn Hån Khóc-th­îng", {2, 1, 931, 1}},
				[11] = {"Gi¸ng Long ThËp B¸t Ch­ëng-th­îng", {2, 1, 934, 1}},
				[12] = {"§¶ CÈu C«n TrËn-th­îng", {2, 1, 937, 1}},
				[14] = {"V« Th­îng Th¸i Cùc KiÕm-th­îng", {2, 1, 940, 1}},
				[15] = {"Th¸i Cùc ThÇn C«ng-th­îng", {2, 1, 943, 1}},
				[17] = {"Liªn Hoµn Toµn Long Th­¬ng-th­îng", {2, 1, 946, 1}},
				[18] = {"B¸ V­¬ng T­êng Phông TiÔn-th­îng", {2, 1, 949, 1}},
				[20] = {"V« Thiªn Ma C«ng-th­îng", {2, 1, 955, 1}},
				[21] = {"V« ¶nh Ma Cæ-th­îng", {2, 1, 952, 1}},
};

tb_ying_book_med = {
				[2] = {"DÞch C©n Kinh-trung", {2, 1, 917, 1}},			
				[4] = {"Nh­ Lai ThÇn Ch­ëng-trung", {2, 1, 920, 1}},			
				[3] = {"TÈy Tñy Kinh-trung", {2, 1, 923, 1}},			
				[6] = {"HÊp Tinh TrËn-trung", {2, 1, 926, 1}},			
				[8] = {"V¹n T­íng ThÇn C«ng-trung", {2, 1, 929, 1}},			
				[9] = {"Thiªn ¢m TrÊn Hån Khóc-trung", {2, 1, 932, 1}},			
				[11] = {"Gi¸ng Long ThËp B¸t Ch­ëng-trung", {2, 1, 935, 1}},			
				[12] = {"§¶ CÈu C«n TrËn-trung", {2, 1, 938, 1}},			
				[14] = {"V« Th­îng Th¸i Cùc KiÕm-trung", {2, 1, 941, 1}},			
				[15] = {"Th¸i Cùc ThÇn C«ng-trung", {2, 1, 944, 1}},			
				[17] = {"Liªn Hoµn Toµn Long Th­¬ng-trung", {2, 1, 947, 1}},			
				[18] = {"B¸ V­¬ng T­êng Phông TiÔn-trung", {2, 1, 950, 1}},			
				[20] = {"V« Thiªn Ma C«ng-trung", {2, 1, 956, 1}}, 
				[21] = {"V« ¶nh Ma Cæ-trung", {2, 1, 953, 1}},
};

tb_ying_book_low = {
				[2] = {"DÞch C©n Kinh-h¹ ", {2, 1, 918, 1}},		
				[4] = {"Nh­ Lai ThÇn Ch­ëng-h¹ ", {2, 1, 921, 1}},		
				[3] = {"TÈy Tñy Kinh-h¹ ", {2, 1, 924, 1}},		
				[6] = {"HÊp Tinh TrËn-h¹ ", {2, 1, 927, 1}},		
				[8] = {"V¹n T­íng ThÇn C«ng-h¹ ", {2, 1, 930, 1}},		
				[9] = {"Thiªn ¢m TrÊn Hån Khóc-h¹ ", {2, 1, 933, 1}},		
				[11] = {"Gi¸ng Long ThËp B¸t Ch­ëng-h¹ ", {2, 1, 936, 1}},		
				[12] = {"§¶ CÈu C«n TrËn-h¹ ", {2, 1, 939, 1}},		
				[14] = {"V« Th­îng Th¸i Cùc KiÕm-h¹ ", {2, 1, 942, 1}},		
				[15] = {"Th¸i Cùc ThÇn C«ng-h¹ ", {2, 1, 945, 1}},		
				[17] = {"Liªn Hoµn Toµn Long Th­¬ng-h¹ ", {2, 1, 948, 1}},		
				[18] = {"B¸ V­¬ng T­êng Phông TiÔn-h¹ ", {2, 1, 951, 1}},		
				[20] = {"V« Thiªn Ma C«ng-h¹ ", {2, 1, 957, 1}},
				[21] = {"V« ¶nh Ma Cæ-h¹ ", {2, 1, 954, 1}},
};

tb_ying_item = {				
				[1] = {"Thiªn Th¹ch Linh Th¹ch",{2,1,1068}, 20 * 24 * 3600},
				[2] = {"B¶n vÏ ®óc t¹o thÇn khÝ",{2,1,1086},0},			
				[3] = {"Kim Lò Th­êng", {0, 100, 95},0},				
				[4] = {"Tµng KiÕm ¤ kim phôc", {0, 101, 95},0},
}

tb_ying_item_2 = {
				[1] = {"Tµng KiÕm Kim Ên", 3, 0, 102, 40},
				[2] = {"Tµng KiÕm Kú Th¹ch", 2, 0, 102, 39},
				[3] = {"Tµng KiÕm Tö Kim m·o", 10, 0, 103, 95},
				[4] = {"Tµng KiÕm B¶o Ch©u", 85, 0, 102, 38},			
}

function check_award_level()
	local nAwordLevel = 0;
	local nLevel = GetLevel();
	local nRep = GetReputation();
	local nFaction = GetTask(336);
	local nHor = GetTask(701);
	if nHor < 0 then
		nHor = 0 - nHor;
	end
	
	for i = 88, 78, -1 do
		if nLevel >= i and nRep >= tb_ying_award[i][1] and nFaction >= tb_ying_award[i][2] and nHor >= tb_ying_award[i][3] then
			nAwordLevel = i;
			break;
		end
	end
	return nAwordLevel;
end
		
function GetEventBit(nBit)
	Talk(1,"","TÝnh n¨ng nhËn th­ëng ®· ®ãng ngµy l©u råi")
	do return end
	return GetBit(GetTask(TSK_YING_AWARD),nBit)
end

function SetEventBit(nBit)
	Talk(1,"","TÝnh n¨ng nhËn th­ëng ®· ®ãng ngµy l©u råi")
	do return end
	local nVal1 = GetTask(TSK_YING_AWARD)
	SetTask(TSK_YING_AWARD,SetBit(GetTask(TSK_YING_AWARD),nBit,1))
	local nVal2 = GetTask(TSK_YING_AWARD)
	if nVal2 > nVal1 then
		return 1
	else
		return 0
	end
end
		
